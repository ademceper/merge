---
description: Core development rules for Merge monorepo
alwaysApply: true
---

# Merge Monorepo - Core Rules

## Project Context
E-commerce monorepo: Next.js 16 (web) + Expo 54 (mobile) with shared packages.

## SEARCH FIRST
Before creating anything new:
1. Search codebase for existing patterns
2. Check packages/ui or packages/uim for components
3. Look for similar implementations to extend

## REUSE FIRST
- Extend existing code before creating new
- Use shared packages (api, store, validators, i18n)
- Smallest possible code changes

## UI PACKAGE COMPONENTS (MANDATORY - CRITICAL RULE)

⚠️ **THIS IS A MANDATORY REQUIREMENT - NO EXCEPTIONS**

**NEVER use native HTML/RN elements when UI package alternatives exist. This rule is enforced and violations must be fixed immediately.**

### Web (apps/web)
- ❌ **FORBIDDEN**: `<button>`, `<input>`, native form elements, native `<a>` tags for buttons
- ✅ **REQUIRED**: `Button`, `Input`, `Field` from `@merge/ui/components/*`
- ✅ **Links**: Use `Button variant="link"` or `Button variant="ghost"` instead of native buttons

### Mobile (apps/mobile)
- ❌ **FORBIDDEN**: `Pressable` (for buttons), native `Text` from react-native, `TextInput` from react-native
- ✅ **REQUIRED**: `Button`, `Text`, `Input` from `@merge/uim/components/*`
- ✅ **Link buttons**: Use `Button variant="ghost"` with `className="h-auto p-0"`

**Before creating ANY UI element, ALWAYS check if a component exists in:**
- `packages/ui/src/components/` (web) - 54 components available
- `packages/uim/src/components/` (mobile) - 32 components available

**If a component doesn't exist, create it in the appropriate package first, then use it.**

## TypeScript Standards
- NEVER use `any` - use `unknown` if truly needed
- Use interfaces for object shapes
- Use Zod for runtime validation
- Avoid enums, prefer literal types

## Component Pattern
```tsx
export function ComponentName({ className, ...props }: ComponentProps) {
  return <div className={cn('base-classes', className)} {...props} />
}
```
- Always `export function`, never `export const` for components
- React 19: No forwardRef needed, refs auto-forward
- Use CVA for variants

## Imports Order
1. React imports
2. External libraries
3. @merge/* packages
4. Relative imports
5. Type imports

## Naming Conventions
- Components: PascalCase
- Functions/variables: camelCase
- Constants: SCREAMING_SNAKE_CASE
- Directories: kebab-case
- Descriptive booleans: `isLoading`, `hasError`, `canSubmit`

## Git Commits
Conventional Commits: `feat:`, `fix:`, `docs:`, `chore:`, `refactor:`, `test:`

## Error Handling
- Handle errors at function start with early returns
- Use guard clauses for preconditions
- Log to Sentry in production
